REM Title: Exercise 7-4 from USB Rubber Ducky: Keystroke Injection Attacks with Advanced DuckyScript
REM Author: Patrick Hirsch <HirschP2@nku.edu>
REM Description: Send a series of lock key presses to animate a "Knight Rider LED Pattern" on the LED indicators

ATTACKMODE HID STORAGE

FUNCTION ALL_LOCK_OFF()
	IF $_NUMLOCK_ON THEN
		NUMLOCK
	END_IF
	IF $_CAPSLOCK_ON THEN
		CAPSLOCK
	END_IF
	IF $_SCROLLLOCK_ON THEN
		SCROLLLOCK
	END_IF
END_FUNCTION

FUNCTION ALL_LOCK_ON()
	IF ( $_NUMLOCK_ON == FALSE ) THEN
		NUMLOCK
	END_IF
	IF ( $_CAPSLOCK_ON == FALSE ) THEN
		CAPSLOCK
	END_IF
	IF ( $_SCROLLLOCK_ON == FALSE ) THEN
		SCROLLLOCK
	END_IF
END_FUNCTION

FUNCTION ONLY_LOCK_NUM()
	IF ( $_NUMLOCK_ON == FALSE ) THEN
		NUMLOCK
	END_IF
	IF $_CAPSLOCK_ON THEN
		CAPSLOCK
	END_IF
	IF $_SCROLLLOCK_ON THEN
		SCROLLLOCK
	END_IF
END_FUNCTION

FUNCTION ONLY_LOCK_CAP()
	IF $_NUMLOCK_ON THEN
		NUMLOCK
	END_IF
	IF ( $_CAPSLOCK_ON == FALSE ) THEN
		CAPSLOCK
	END_IF
	IF $_SCROLLLOCK_ON THEN
		SCROLLLOCK
	END_IF
END_FUNCTION

FUNCTION ONLY_LOCK_SCROLL()
	IF $_NUMLOCK_ON THEN
		NUMLOCK
	END_IF
	IF $_CAPSLOCK_ON THEN
		CAPSLOCK
	END_IF
	IF ( $_SCROLLLOCK_ON == FALSE ) THEN
		SCROLLLOCK
	END_IF
END_FUNCTION

VAR $index = 0
VAR $DELAY_VAL = 100
WHILE TRUE
    $index = 0
    WHILE ( $index <= 2 )
        ALL_LOCK_ON()
		DELAY $DELAY_VAL
        ALL_LOCK_OFF()
		DELAY $DELAY_VAL
        $index = ( $index + 1 )
    END_WHILE

    $index = 0
    WHILE ( $index <= 5 )
        ONLY_LOCK_NUM()
		DELAY $DELAY_VAL
        ONLY_LOCK_CAP()
		DELAY $DELAY_VAL
        ONLY_LOCK_SCROLL()
		DELAY $DELAY_VAL
        ONLY_LOCK_CAP()
		DELAY $DELAY_VAL
        ONLY_LOCK_NUM()
		DELAY $DELAY_VAL
        $index = ( $index + 1 )
    END_WHILE
END_WHILE