REM Title: Exercise 1-3 from USB Rubber Ducky: Keystroke Injection Attacks with Advanced DuckyScript
REM Author: Patrick Hirsch <HirschP2@nku.edu>
REM Description: For Windows 10, opens PS terminal, runs ls, copies terminal output to notepad after 5 seconds

REM Set attackmode as an HID device; leave storage for easy re-arming
ATTACKMODE HID STORAGE

REM Obligitory enumeration delay:
DELAY 2000

REM Open 'Run' and wait for it to finish opening
GUI r
DELAY 100

REM Open PowerShell pre-loaded with commands to do listing and wait 5 seconds
STRING powershell -NoExit ls
ENTER

REM Wait 5 seconds, select all text in terminal window and copy
DELAY 5000
ALT SPACE
STRING e
STRING s
CTRL c

REM Open Run, then notepad
GUI r
DELAY 100
STRING notepad
ENTER

REM Paste once Notepad opens
DELAY 100
CTRL v